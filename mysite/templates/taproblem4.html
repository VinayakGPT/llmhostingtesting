{% extends "base2.html" %}
{% block title %}Problem 4{% endblock %} 

{% block content %}
<form id="taproblem4-form" method="post" novalidate>
    {% csrf_token %} 
    <div class="container">
        <br>
        <h2>4. Smallest Prime: Type-1</h2>
        <div class="problem-statement">
            <pre class="wrap"><h5><b>Problem Statement:</b></h5>Given a positive integer N, print the number p, such that p is the smallest prime number greater than or equal to N.
Example:
Input: 11
Output: 11
Input: 22
Output: 23
Input: 1
Output: 2</pre>
        </div>
        <p><pre class="wraptext"><h5><b>Incorrect Solution:</b></h5><code><span class="keyword">#include</span> <span class="string">&lt;stdio.h&gt;</span>
<span class="keyword">int</span> <span class="function">check_prime</span>(<span class="keyword">int</span> num) {
    <span class="keyword">int</span> j = 2;
    <span class="keyword">while</span> (j <= num - 1) {
        <span class="keyword">if</span> (num % j == 0)
            <span class="keyword">return</span> 0;
        j++;
    }
    <span class="keyword">return</span> 1;
}
 
<span class="keyword">int</span> <span class="function">main</span>() {
    <span class="keyword">int</span> N, result;
    scanf(<span class="string">"%d"</span>, &N);

    <span class="keyword">while</span> (!check_prime(N)) {
        N++;
    }
    printf(<span class="string">"%d"</span>, N);
    <span class="keyword">return</span> 0;
}</code></pre></p>


        <ul class="nav nav-tabs" id="feedbackTabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="feedback1-tab" data-toggle="tab" href="#feedback1" role="tab" aria-controls="feedback1" aria-selected="true">Feedback 1</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="feedback2-tab" data-toggle="tab" href="#feedback2" role="tab" aria-controls="feedback2" aria-selected="false">Feedback 2</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="feedback3-tab" data-toggle="tab" href="#feedback3" role="tab" aria-controls="feedback3" aria-selected="false">Feedback 3</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="feedback4-tab" data-toggle="tab" href="#feedback4" role="tab" aria-controls="feedback4" aria-selected="false">Feedback 4</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="feedback5-tab" data-toggle="tab" href="#feedback5" role="tab" aria-controls="feedback5" aria-selected="false">Feedback 5</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="feedback6-tab" data-toggle="tab" href="#feedback6" role="tab" aria-controls="feedback6" aria-selected="false">Feedback 6</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="feedback7-tab" data-toggle="tab" href="#feedback7" role="tab" aria-controls="feedback7" aria-selected="false">Feedback 7</a>
            </li>
        </ul>

        
        <div class="tab-content" id="feedbackTabsContent">
            <!-- Feedback 1 -->
            <div class="tab-pane fade show active" id="feedback1" role="tabpanel" aria-labelledby="feedback1-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
The given solution contains an infinite loop since it never updates the condition to exit the loop (`while (i>=N)`) because the initial setup ensures `i` always remains greater than or equal to `N`. Moreover, the `check_prime` function in the given solution is operational but inefficient as it unnecessarily checks divisibility all the way up to `num-1` and it also lacks a condition to handle the edge case of `num=1` which is not a prime number. In summary, the given solution fails to terminate due to its flawed loop condition and does not efficiently or correctly identify prime numbers.
                    </pre>
                    
                    <label for="feedback41_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="41">
                            <span class="star {% if feedback_data.feedback41 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback41 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback41 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback41 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback41 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback41_rating" id="feedback41_rating" value="{{ feedback_data.feedback41 }}">
                    <button class="btn btn-primary next-btn mt-3" data-next-tab="feedback2-tab">Save & Next</button>
                </div>
            </div>
            
            <!-- Feedback 2 -->
            <div class="tab-pane fade" id="feedback2" role="tabpanel" aria-labelledby="feedback2-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
In the given solution, the loop in `main()` is constructed to start checking from `N` and should only increment `i` if `check_prime(i)` returns false (i is not prime), continuing until it finds a prime number. However, the loop condition `while (i >= N)` does not correctly encapsulate this logic. It allows the loop to run indefinitely since `i` is initialized as `N`, and it only increases (`i = i + 1`). This makes the loop condition always true. The `check_prime` function in the given solution returns 1 if the number is prime and 0 if not, but it does not handle the special case for 1. Additionally, `check_prime` uses a less efficient method to determine if a number is prime by iterating from 2 to `num-1`. A more efficient approach is to iterate only up to `num / 2` or even better up to the square root of `num`.
In conclusion, the key errors in the given program are the loop condition in `main()` which allows for an infinite loop, and the inefficient approach used in `check_prime`. Additionally, there are logical issues related to handling the case where `num` is equal to 1. 
                    </pre>
                    
                    <label for="feedback42_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="42">
                            <span class="star {% if feedback_data.feedback42 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback42 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback42 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback42 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback42 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback42_rating" id="feedback42_rating" value="{{ feedback_data.feedback42 }}">
                    <button class="btn btn-primary next-btn mt-3" data-next-tab="feedback3-tab">Save & Next</button>
                </div>
            </div>

            <!-- Feedback 3 -->
            <div class="tab-pane fade" id="feedback3" role="tabpanel" aria-labelledby="feedback3-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
The given solution contains a few logical errors which prevent it from producing correct results, specifically for certain edge cases such as when the input is `1`. Here are the key issues:
1. **Looping Condition in `main`**: 
- The given solution uses `while (i >= N)` which essentially would never conclude if `i` remains greater than or equal to `N`. This should be an endless condition as `i` always starts at `N` and only increases. However, misinterpretation in increment logic combined with intention to utilize a prime-check function messes this up.
2. **Prime Checking Logic in `check_prime`**:
- The function lacks the special case for `num == 1`. In other words, in the given program, if the number `1` is checked, it would incorrectly return `1` (prime) since there's no specific provision or breaking condition in the check logic for `1`. Prime numbers are defined as numbers greater than `1` with no divisors other than `1` and itself, so failing to handle the edge case of `1` directly leads to incorrect results for some inputs, like `1`.
3. **Endless Execution**:
- Due to the aforementioned reasons, especially the loop condition in `main` and the unhandled input of `1` in `check_prime`, the program results in endless or incorrect computations, failing practical execution for certain inputs.
To summarize:
The given solution does not correctly handle the case when `N` is `1` and has an erroneous loop condition that would potentially run indefinitely.
                    </pre>
                    
                    <label for="feedback43_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="43">
                            <span class="star {% if feedback_data.feedback43 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback43 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback43 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback43 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback43 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback43_rating" id="feedback43_rating" value="{{ feedback_data.feedback43 }}">
                    <button class="btn btn-primary next-btn mt-3" data-next-tab="feedback4-tab">Save & Next</button>
                </div>
            </div>

            <!-- Feedback 4 -->
            <div class="tab-pane fade" id="feedback4" role="tabpanel" aria-labelledby="feedback4-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
The given solution has a function `check_prime` which incorrectly designates every number greater than 1 as non-prime by returning 1 if the number is not divisible by any numbers from 2 up to itself minus one. The loop in the given solution is `while (i >= N)`, which continually increments `i` without any condition to stop if `i` is prime, thus likely causing an infinite loop if `N` is already a prime number. The given solution should print the first prime number greater than or equal to N, but due to logical errors, it doesn't output the expected value.
**Summary**: The given solution has a flawed prime-checking function and a loop condition that would not properly terminate under certain conditions (e.g., if N is already a prime number), potentially resulting in incorrect output or infinite loops. Both solutions exhibit issues in their prime-checking logic, making them unreliable.           
                    </pre>
                    
                    <label for="feedback44_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="44">
                            <span class="star {% if feedback_data.feedback44 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback44 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback44 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback44 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback44 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback44_rating" id="feedback44_rating" value="{{ feedback_data.feedback44 }}">
                    <button class="btn btn-primary next-btn mt-3" data-next-tab="feedback5-tab">Save & Next</button>
                </div>
            </div>

            <!-- Feedback 5 -->
            <div class="tab-pane fade" id="feedback5" role="tabpanel" aria-labelledby="feedback5-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
The given solution uses an inefficient method by iterating from 2 to num-1 to check for factors, and the function incorrectly returns 1 for all numbers, as there is no checking for num <=1, which implies it should return 0 for num=1 instead of 1. The given solution contains a logical error in the while loop condition `while (i>=N)` which creates an infinite loop unless `i` is immediately found to be prime, because `i` is incremented without any boundary that stops the loop when a prime is found. The given solution does not ensure the correct detection of prime numbers (due to its flawed prime checking logic) and risks running indefinitely due to improper loop control.
**Summary of Errors in Given Solution:**
- The prime checking function is flawed both in its range (tests unnecessary numbers) and logical inaccuracies for determining non-prime status correctly.
- The main function's while loop is improperly controlled, risking an infinite loop due to a condition that does not account for the termination when the next prime is found.
- Incorrect handling of boundary values such as input `1`, which should specifically yield `2`, not `1`.
                    </pre>
                    
                    <label for="feedback45_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="45">
                            <span class="star {% if feedback_data.feedback45 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback45 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback45 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback45 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback45 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback45_rating" id="feedback45_rating" value="{{ feedback_data.feedback45 }}">
                    <button class="btn btn-primary next-btn mt-3" data-next-tab="feedback6-tab">Save & Next</button>
                </div>
            </div>
            <!-- Feedback 6 -->
            <div class="tab-pane fade" id="feedback6" role="tabpanel" aria-labelledby="feedback6-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
{{ ta1_feedback4 }}
</pre>
                    
                    <label for="feedback46_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="46">
                            <span class="star {% if feedback_data.feedback46 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback46 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback46 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback46 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback46 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback46_rating" id="feedback46_rating" value="{{ feedback_data.feedback46 }}">
                    <button class="btn btn-primary next-btn mt-3" data-next-tab="feedback7-tab">Save & Next</button>
                </div>
            </div>

            <!-- Feedback 7 -->
            <div class="tab-pane fade" id="feedback7" role="tabpanel" aria-labelledby="feedback7-tab">
                <div class="feedback-content">
                    <pre class="wrap">
                        
{{ ta2_feedback4 }}
</pre>
                    
                    <label for="feedback47_rating">How helpful is the feedback to understand the logical error(s) in the given program?</label>
                    <div class="feedback-rating-container">
                        <div class="feedback-label not-helpful">Not Helpful</div>
            
                        <div class="star-rating mt-3" data-feedback-id="47">
                            <span class="star {% if feedback_data.feedback47 >= 1 %}filled{% endif %}" data-value="1">&#9733;</span>
                            <span class="star {% if feedback_data.feedback47 >= 2 %}filled{% endif %}" data-value="2">&#9733;</span>
                            <span class="star {% if feedback_data.feedback47 >= 3 %}filled{% endif %}" data-value="3">&#9733;</span>
                            <span class="star {% if feedback_data.feedback47 >= 4 %}filled{% endif %}" data-value="4">&#9733;</span>
                            <span class="star {% if feedback_data.feedback47 >= 5 %}filled{% endif %}" data-value="5">&#9733;</span>
                        </div>
            
                        <div class="feedback-label helpful">Very Helpful</div>
                    </div>
                    <input type="hidden" name="feedback47_rating" id="feedback47_rating" value="{{ feedback_data.feedback47 }}">
                    <button type="submit" class="btn btn-primary">Next Problem</button>
                </div>
            </div>
        </div>
    </div>
</form> 

<nav aria-label="Page navigation example" class="mt-4">
    <ul class="pagination justify-content-center">
        <li class="page-item {% if 1 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem1' 1 %}">1</a>
        </li>
        <li class="page-item {% if 2 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem2' 2 %}">2</a>
        </li>
        <li class="page-item {% if 3 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem3' 3 %}">3</a>
        </li>
        <li class="page-item {% if 4 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem4' 4 %}">4</a>
        </li>
        <li class="page-item {% if 5 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem5' 5 %}">5</a>
        </li>
        <li class="page-item {% if 6 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem6' 6 %}">6</a>
        </li>
        <li class="page-item {% if 7 not in visited_pages %}disabled{% endif %}">
            <a class="page-link" href="{% url 'taproblem7' 7 %}">7</a>
        </li>
    </ul>
</nav>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.nav-item .nav-link');

        const isFirstVisit4 = localStorage.getItem('firstVisit4') === null;

        if (isFirstVisit4) {
            tabs.forEach((tab, index) => {
                if (index !== 0) {
                    tab.classList.add('disabled');
                }
            });
        } else {
            tabs.forEach((tab, index) => {
                const tabId = tab.getAttribute('href').substring(1); 
                const isTabUnlocked = localStorage.getItem(`tabUnlocked_${tabId}`) === 'true';

                if (isTabUnlocked || index === 0) {
                    tab.classList.remove('disabled');
                }
            });
        }

        function checkAllFeedbackRatings() {
            const unfilledFeedback = [];

            document.querySelectorAll('.tab-pane').forEach(tab => {
                const hiddenInputs = tab.querySelectorAll('input[type="hidden"]');

                hiddenInputs.forEach(hiddenInput => {
                    const feedbackId = hiddenInput.getAttribute('name').match(/\d+/)[0];
                    const selectedRating = hiddenInput.value;

                    if (!selectedRating || selectedRating === '0') {
                        unfilledFeedback.push(`Feedback ${feedbackId.charAt(feedbackId.length - 1)}`);
                    }
                });
            });

            return unfilledFeedback;
        }

        document.querySelector('.btn-primary[type="submit"]').addEventListener('click', (e) => {
            const unfilledFeedback = checkAllFeedbackRatings();

            if (unfilledFeedback.length > 0) {
                alert(`Please rate these feedbacks to move on to the next problem: ${unfilledFeedback.join(', ')}`);
                e.preventDefault();
            } else {
                localStorage.setItem('firstVisit4', 'true');
            }
        });

        document.querySelectorAll('.next-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
        
                const currentTabPane = button.closest('.tab-pane');
                const feedbackItems = currentTabPane.querySelectorAll('.star-rating');
                const unfilledFeedback = [];
        
                feedbackItems.forEach(feedback => {
                    const feedbackId = feedback.getAttribute('data-feedback-id');
                    const savedRating = localStorage.getItem(`feedback${feedbackId}_rating`);
        
                    if (!savedRating || savedRating === '0') {
                        unfilledFeedback.push(`Feedback ${feedbackId}`);
                    }
                });
        
                if (unfilledFeedback.length > 0) {
                    alert(`Please rate the given feedback before moving to the next tab`);
                    return;
                }
        
                const nextTabId = button.getAttribute('data-next-tab');
                const nextTab = document.getElementById(nextTabId);
        
                if (nextTab) {
                    nextTab.classList.remove('disabled');
                    localStorage.setItem(`tabUnlocked_${nextTabId}`, 'true');
        
                    const currentTab = currentTabPane.id;
                    const currentNavLink = document.querySelector(`[href="#${currentTab}"]`);
                    currentNavLink.classList.remove('disabled');
        
                    nextTab.click();
                }
            });
        });

        document.querySelectorAll('.star-rating').forEach(starRatingDiv => {
            const feedbackId = starRatingDiv.getAttribute('data-feedback-id');
            const hiddenInput = document.querySelector(`input[name='feedback${feedbackId}_rating']`);

            if (!hiddenInput) {
                console.error(`Hidden input for feedback ${feedbackId} not found`);
                return;
            }

            const savedRating = localStorage.getItem(`feedback${feedbackId}_rating`);
            if (savedRating) {
                hiddenInput.value = savedRating;

                const stars = Array.from(starRatingDiv.querySelectorAll('.star'));
                for (let i = 0; i < savedRating; i++) {
                    stars[i].classList.add('filled');
                }
            }

            starRatingDiv.querySelectorAll('.star').forEach(star => {
                star.addEventListener('click', () => {
                    const value = star.getAttribute('data-value');
                    const stars = Array.from(star.parentElement.children);

                    stars.forEach(s => s.classList.remove('filled'));

                    for (let i = 0; i < value; i++) {
                        stars[i].classList.add('filled');
                    }

                    hiddenInput.value = value;

                    localStorage.setItem(`feedback${feedbackId}_rating`, value);
                });
            });
        });

        tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                if (tab.classList.contains('disabled')) {
                    e.preventDefault();
                }
            });
        });

        tabs[0].classList.remove('disabled');
    }); 
</script>


<style>
    .feedback-rating-container {
        display: flex;
        align-items: baseline; 
        justify-content: center; 
        margin-top: 1rem; 
    }
    
    .star-rating .star {
        font-size: 30px; 
        color: #ddd; 
        cursor: pointer;
        transition: color 0.2s;
    }
    
    .mt-3, .my-3 {
        margin-top: 1rem !important;
        text-align: center;
    }
    
    .star-rating .star.filled {
        color: #ffc107; 
    }
    
    .not-helpful {
        color: red;
        position: relative;
        right: 0.6rem;
        bottom: 0.2rem;
        font-weight: 600;
    }
    
    .helpful {
        color: green;
        position: relative;
        left: 0.6rem;
        bottom: 0.2rem;
        font-weight: 600;
    }

    label {
        font-weight: 600;
    }
</style>

{% endblock %}
